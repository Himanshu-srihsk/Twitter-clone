package com.fun.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;
import org.springframework.web.cors.CorsConfigurationSource;

@Configuration
@EnableWebSecurity
public class AppConfig {
  public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception{
	  http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()
	  .authorizeHttpRequests(Authorize-> Authorize.requestMatchers("/api/**").authenticated()
			  .anyRequest().permitAll()).addFilterBefore(null, BasicAuthenticationFilter.class)
	  .csrf().disable()
	  .cors().configurationSource(CorsConfigurationSource())
	  .and()
	  .httpBasic().and().formLogin();
	return http.build();
  }
}
